# Aggregate statistics
- Aggregate statistics are values computed on entire sets of data
- Counts, sums, and averages are explains of aggregate statistics

    SELECT COUNT(*) FROM bookstore_sales;

- If you add a WHERE clause, COUNT will only consider rows matching the WHERE clause:

    SELECT COUNT(*)
    FROM bookstore_sales
    WHERE payment = 'cash';

- The use of * within the aggregate function is unique to COUNT
- Other aggregate functions require application to a column or an expression
- When applied to a column or expression, COUNT and the other aggregate functions ignore NULL values

    SELECT COUNT(*), COUNT(author_id), COUNT(birth), COUNT(death)
    FROM authors;

- In addition to COUNT, the most common aggregate functions implemented by SQLite are SUM, AVG, MIN, and MAX
- As with COUNT, the argument of the function is a column or expression, which is evaluated for every row
- For all aggregates except COUNT, if the argument evaluates to NULL for every row, then the result is NULL
- It is possible to indicate that duplicate values should be ignore by putting the DISTINCT keyword before the argument of the aggregate function

# Grouping
- Aggregates can be very useful when applied to an entire table or to a set of rows matching a WHERE clause
- GROUP BY lets us specify an attribute, such as the condition of a book, by which to organize a table into groups
- All members of a group share the same value for the expression
- The groups form a partition of the data
- Every row is assigned to a group, and no row is assigned to more than one group
- No row is assigned to more than one group

    SELECT condition, COUNT(*), AVG(price)
    FROM bookstore_inventory
    GROUP BY condition;

- If we want to exclude books that have already been sold, we could add a WHERE clause

    SELECT condition, COUNT(*), AVG(price)
    FROM bookstore_inventory
    WHERE stock_number NOT IN
      (SELECT stock_number FROM bookstore_sales)
    GROUP BY condition;

# Filtering grouped data
- When we group, we are generating a new set of rows representing the groups present in our data
- If we include a WHERE clause in our query, it is applied to the data before grouping
- The WHERE clause, then, cannot be used to filter the set of rows produced by grouping
- If we want to filter the grouped data, we must do so using a HAVING clause
- The HAVING clause works just like the WHERE clause, but applies to the set of rows generated by grouping
- Using HAVING, we can filter by expression available to us after grouping: any expressions that we grouped by, or aggregate functions on the group
- The HAVING clause comes after the GROUP BY clause

    SELECT author, title, COUNT(*)
    FROM bookstore_inventory
    GROUP BY author, title
    HAVING COUNT(*) > 1
    ORDER BY COUNT(*) DESC;
